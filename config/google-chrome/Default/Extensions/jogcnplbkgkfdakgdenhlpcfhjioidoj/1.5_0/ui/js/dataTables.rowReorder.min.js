/*! For license information please see dataTables.rowReorder.min.js.LICENSE.txt */
!function(t){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],(function(e){return t(e,window,document)})):"object"==typeof exports?module.exports=function(e,o){return e=e||window,(o=o||("undefined"!=typeof window?require("jquery"):require("jquery")(e))).fn.dataTable||require("datatables.net")(e,o),t(o,e,e.document)}:t(jQuery,window,document)}((function(t,e,o,r){"use strict";function n(e,o){if(!s.versionCheck||!s.versionCheck("1.10.8"))throw"DataTables RowReorder requires DataTables 1.10.8 or newer";if(this.c=t.extend(!0,{},s.defaults.rowReorder,n.defaults,o),this.s={bodyTop:null,dt:new s.Api(e),getDataFn:s.ext.oApi._fnGetObjectDataFn(this.c.dataSrc),middles:null,scroll:{},scrollInterval:null,setDataFn:s.ext.oApi._fnSetObjectDataFn(this.c.dataSrc),start:{top:0,left:0,offsetTop:0,offsetLeft:0,nodes:[]},windowHeight:0,documentOuterHeight:0,domCloneOuterHeight:0},this.dom={clone:null,cloneParent:null,dtScroll:t("div.dataTables_scrollBody",this.s.dt.table().container())},e=(o=this.s.dt.settings()[0]).rowreorder)return e;this.dom.dtScroll.length||(this.dom.dtScroll=t(this.s.dt.table().container(),"tbody")),(o.rowreorder=this)._constructor()}var s=t.fn.dataTable,i=(t.extend(n.prototype,{_constructor:function(){var e=this,o=this.s.dt,r=t(o.table().node());"static"===r.css("position")&&r.css("position","relative"),t(o.table().container()).on("mousedown.rowReorder touchstart.rowReorder",this.c.selector,(function(r){var n,s;if(e.c.enable)return!!t(r.target).is(e.c.excludedChildren)||(n=t(this).closest("tr"),(s=o.row(n)).any()?(e._emitEvent("pre-row-reorder",{node:s.node(),index:s.index()}),e._mouseDown(r,n),!1):void 0)})),o.on("destroy.rowReorder",(function(){t(o.table().container()).off(".rowReorder"),o.off(".rowReorder")}))},_cachePositions:function(){var r=this.s.dt,n=t(r.table().node()).find("thead").outerHeight(),s=t.unique(r.rows({page:"current"}).nodes().toArray());s=t.map(s,(function(e,o){var r=t(e).position().top-n;return(r+r+t(e).outerHeight())/2})),this.s.middles=s,this.s.bodyTop=t(r.table().body()).offset().top,this.s.windowHeight=t(e).height(),this.s.documentOuterHeight=t(o).outerHeight()},_clone:function(e){var o=this.s.dt,r=(o=t(o.table().node().cloneNode(!1)).addClass("dt-rowReorder-float").append("<tbody/>").append(e.clone(!1)),e.outerWidth()),n=e.outerHeight(),s=(i=t(t(this.s.dt.table().node()).parent())).width(),i=i.scrollLeft(),d=e.children().map((function(){return t(this).width()}));o.width(r).height(n).find("tr").children().each((function(t){this.style.width=d[t]+"px"})),e=t("<div>").addClass("dt-rowReorder-float-parent").width(s).append(o).appendTo("body").scrollLeft(i),this.dom.clone=o,this.dom.cloneParent=e,this.s.domCloneOuterHeight=o.outerHeight()},_clonePosition:function(t){var e=this.s.start,o=this._eventToPage(t,"Y")-e.top,r=(t=this._eventToPage(t,"X")-e.left,this.c.snapX);o+=e.offsetTop,r=!0===r?e.offsetLeft:"number"==typeof r?e.offsetLeft+r:t+e.offsetLeft+this.dom.cloneParent.scrollLeft(),o<0?o=0:o+this.s.domCloneOuterHeight>this.s.documentOuterHeight&&(o=this.s.documentOuterHeight-this.s.domCloneOuterHeight),this.dom.cloneParent.css({top:o,left:r})},_emitEvent:function(e,o){this.s.dt.iterator("table",(function(r,n){t(r.nTable).triggerHandler(e+".dt",o)}))},_eventToPage:function(t,e){return(-1!==t.type.indexOf("touch")?t.originalEvent.touches[0]:t)["page"+e]},_mouseDown:function(r,n){var s=this,i=this.s.dt,d=this.s.start,l=n.offset();d.top=this._eventToPage(r,"Y"),d.left=this._eventToPage(r,"X"),d.offsetTop=l.top,d.offsetLeft=l.left,d.nodes=t.unique(i.rows({page:"current"}).nodes().toArray()),this._cachePositions(),this._clone(n),this._clonePosition(r),(this.dom.target=n).addClass("dt-rowReorder-moving"),t(o).on("mouseup.rowReorder touchend.rowReorder",(function(t){s._mouseUp(t)})).on("mousemove.rowReorder touchmove.rowReorder",(function(t){s._mouseMove(t)})),t(e).width()===t(o).width()&&t(o.body).addClass("dt-rowReorder-noOverflow"),l=this.dom.dtScroll,this.s.scroll={windowHeight:t(e).height(),windowWidth:t(e).width(),dtTop:l.length?l.offset().top:null,dtLeft:l.length?l.offset().left:null,dtHeight:l.length?l.outerHeight():null,dtWidth:l.length?l.outerWidth():null}},_mouseMove:function(e){this._clonePosition(e);for(var o=this._eventToPage(e,"Y")-this.s.bodyTop,r=this.s.middles,n=null,s=this.s.dt,i=0,d=r.length;i<d;i++)if(o<r[i]){n=i;break}null===n&&(n=r.length),null!==this.s.lastInsert&&this.s.lastInsert===n||(s=t.unique(s.rows({page:"current"}).nodes().toArray()),n>this.s.lastInsert?this.dom.target.insertAfter(s[n-1]):this.dom.target.insertBefore(s[n]),this._cachePositions(),this.s.lastInsert=n),this._shiftScroll(e)},_mouseUp:function(e){for(var r,n,s,i=this,d=this.s.dt,l=this.c.dataSrc,a=(this.dom.clone.remove(),this.dom.cloneParent.remove(),this.dom.clone=null,this.dom.cloneParent=null,this.dom.target.removeClass("dt-rowReorder-moving"),t(o).off(".rowReorder"),t(o.body).removeClass("dt-rowReorder-noOverflow"),clearInterval(this.s.scrollInterval),this.s.scrollInterval=null,this.s.start.nodes),c=t.unique(d.rows({page:"current"}).nodes().toArray()),h={},u=[],f=[],w=this.s.getDataFn,p=this.s.setDataFn,m=0,g=a.length;m<g;m++)a[m]!==c[m]&&(r=d.row(c[m]).id(),n=d.row(c[m]).data(),s=d.row(a[m]).data(),r&&(h[r]=w(s)),u.push({node:c[m],oldData:w(n),newData:w(s),newPosition:m,oldPosition:t.inArray(c[m],a)}),f.push(c[m]));function v(){if(i.c.update){for(m=0,g=u.length;m<g;m++){var t=d.row(u[m].node).data();p(t,u[m].newData),d.columns().every((function(){this.dataSrc()===l&&d.cell(u[m].node,this.index()).invalidate("data")}))}i._emitEvent("row-reordered",b),d.draw(!1)}}var b=[u,{dataSrc:l,nodes:f,values:h,triggerRow:d.row(this.dom.target),originalEvent:e}];this._emitEvent("row-reorder",b),this.c.editor?(this.c.enable=!1,this.c.editor.edit(f,!1,t.extend({submit:"changed"},this.c.formOptions)).multiSet(l,h).one("preSubmitCancelled.rowReorder",(function(){i.c.enable=!0,i.c.editor.off(".rowReorder"),d.draw(!1)})).one("submitUnsuccessful.rowReorder",(function(){d.draw(!1)})).one("submitSuccess.rowReorder",(function(){v()})).one("submitComplete",(function(){i.c.enable=!0,i.c.editor.off(".rowReorder")})).submit()):v()},_shiftScroll:function(r){var n,s,i=this,d=(this.s.dt,this.s.scroll),l=!1,a=r.pageY-o.body.scrollTop;a<t(e).scrollTop()+65?n=-5:a>d.windowHeight+t(e).scrollTop()-65&&(n=5),null!==d.dtTop&&r.pageY<d.dtTop+65?s=-5:null!==d.dtTop&&r.pageY>d.dtTop+d.dtHeight-65&&(s=5),n||s?(d.windowVert=n,d.dtVert=s,l=!0):this.s.scrollInterval&&(clearInterval(this.s.scrollInterval),this.s.scrollInterval=null),!this.s.scrollInterval&&l&&(this.s.scrollInterval=setInterval((function(){var e;d.windowVert&&(e=t(o).scrollTop(),t(o).scrollTop(e+d.windowVert),e!==t(o).scrollTop())&&(e=parseFloat(i.dom.cloneParent.css("top")),i.dom.cloneParent.css("top",e+d.windowVert)),d.dtVert&&(e=i.dom.dtScroll[0],d.dtVert)&&(e.scrollTop+=d.dtVert)}),20))}}),n.defaults={dataSrc:0,editor:null,enable:!0,formOptions:{},selector:"td:first-child",snapX:!1,update:!0,excludedChildren:"a"},t.fn.dataTable.Api);return i.register("rowReorder()",(function(){return this})),i.register("rowReorder.enable()",(function(t){return t===r&&(t=!0),this.iterator("table",(function(e){e.rowreorder&&(e.rowreorder.c.enable=t)}))})),i.register("rowReorder.disable()",(function(){return this.iterator("table",(function(t){t.rowreorder&&(t.rowreorder.c.enable=!1)}))})),n.version="1.3.1",t.fn.dataTable.RowReorder=n,t.fn.DataTable.RowReorder=n,t(o).on("init.dt.dtr",(function(e,o,r){var i,d;"dt"===e.namespace&&(e=o.oInit.rowReorder,i=s.defaults.rowReorder,e||i)&&(d=t.extend({},e,i),!1!==e)&&new n(o,d)})),s}));